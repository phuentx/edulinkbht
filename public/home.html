<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>EduLink</title>
<link rel="icon" type="image/png" href="https://i.imghippo.com/files/vgr8207c.png">
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://unpkg.com/lucide@latest"></script>
<script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>
<style>
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Google+Sans:wght@400;500;700&display=swap');
:root{--surface:#ffffff;--background:#ffffff;--on-surface:#0f0f0f;--text-secondary:#606060;--outline:#e5e7eb;--hover-bg:#f2f2f2;--primary:#065fd4}
body{font-family:'Inter',sans-serif;background-color:var(--background);color:var(--on-surface);overflow:hidden}
h1,h2,h3,.google-font{font-family:'Google Sans','Inter',sans-serif}
*{scrollbar-width:none;-ms-overflow-style:none}*::-webkit-scrollbar{width:0;display:none}
.fade-in{animation:fadeUp 0.4s cubic-bezier(0.2,0,0,1) forwards;opacity:0;transform:translateY(10px)}
@keyframes fadeUp{to{opacity:1;transform:translateY(0)}}
.app-panel{background:var(--surface);border:none;height:100%;display:flex;flex-direction:column;overflow:hidden;transition:all .3s}
@media(min-width:768px){.app-panel{border-radius:20px;border:1px solid var(--outline)}}
#main-sidebar{width:88px;flex-shrink:0;padding:24px 12px}@media(min-width:1024px){#main-sidebar{width:260px;padding:24px 20px}}
.nav-item{display:flex;align-items:center;gap:14px;padding:12px;color:var(--text-secondary);font-weight:500;border-radius:12px;cursor:pointer;margin-bottom:4px;justify-content:center;position:relative}
.nav-item:hover{color:var(--on-surface);background-color:var(--hover-bg)}.nav-item.active{color:var(--primary);background-color:#eff4ff;font-weight:600}
.nav-badge,.mobile-footer-badge{position:absolute;background-color:#c00;color:#fff;font-size:10px;font-weight:700;height:16px;min-width:16px;border-radius:10px;display:none;align-items:center;justify-content:center;border:2px solid #fff;z-index:10}
.nav-badge{top:10px;right:12px}.mobile-footer-badge{top:-4px;right:-4px;z-index:20}
@media(min-width:1024px){.nav-item{justify-content:flex-start;padding:10px 16px}.nav-badge{right:auto;left:28px;top:8px}}
.create-btn{display:flex;align-items:center;gap:12px;background:#1f1f1f;color:#fff;padding:12px 20px;border-radius:12px;font-weight:500;width:100%;margin-bottom:24px}
.post-card{background:var(--surface);border-bottom:1px solid var(--outline);margin-bottom:0;cursor:pointer}
.post-card:hover{background-color:#fdfdfd}.post-header{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:12px}
.post-avatar{width:40px;height:40px;border-radius:50%;background-color:var(--hover-bg);object-fit:cover}
.action-btn{display:flex;align-items:center;gap:8px;padding:8px;border-radius:18px;color:var(--on-surface);font-size:13px;font-weight:500}
.action-btn:hover{background-color:var(--hover-bg)}.action-btn.like.active svg{fill:#f00;stroke:none}.action-btn.bookmark.active svg{fill:#eab308;stroke:#eab308}
.create-option-card{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:24px;border-radius:16px;border:1px solid var(--outline);cursor:pointer;gap:12px;height:140px}
.create-option-card:hover{border-color:var(--primary);background:#eff4ff;transform:translateY(-2px)}
.create-icon-bg{width:56px;height:56px;border-radius:50%;background:var(--hover-bg);display:flex;align-items:center;justify-content:center}
.toast{position:fixed;bottom:100px;left:50%;transform:translateX(-50%) translateY(20px);background:#0f0f0f;color:#f2f2f2;padding:14px 28px;border-radius:48px;font-size:15px;opacity:0;pointer-events:none;transition:all .3s;z-index:200}
.toast.show{opacity:1;transform:translateX(-50%) translateY(0)}
.tab-btn{flex:1;padding:14px 0;font-size:14px;font-weight:600;color:var(--text-secondary);cursor:pointer;text-align:center;position:relative;display:flex;align-items:center;justify-content:center;gap:8px}
.tab-btn.active{color:var(--on-surface)}.tab-btn.active::after{content:'';position:absolute;bottom:0;left:50%;transform:translateX(-50%);width:60px;height:4px;background-color:var(--on-surface);border-radius:4px 4px 0 0}
.grid-post-container{display:grid;grid-template-columns:repeat(3,1fr);gap:4px}@media(min-width:768px){.grid-post-container{gap:16px}}
.grid-post-item{position:relative;aspect-ratio:4/5;overflow:hidden;cursor:pointer;background-color:#f3f4f6;border-radius:12px}
.mobile-nav-item{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;flex:1;gap:4px;cursor:pointer}
.mobile-nav-item.active i{transform:scale(1.1);stroke-width:2.5px;fill:var(--on-surface)}
#app-loader{position:fixed;inset:0;background:var(--surface);z-index:9999;display:flex;justify-content:center;align-items:center;transition:opacity .5s}
.loader-spinner{width:40px;height:40px;border:4px solid var(--hover-bg);border-top-color:var(--primary);border-radius:50%;animation:spin 1s linear infinite}
@keyframes spin{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}
.post-modal-layout{display:flex;flex-direction:column;width:100%;height:100%;overflow:hidden}
@media(min-width:768px){.post-modal-layout{flex-direction:row;width:90vw;max-width:1200px;height:85vh;background:0 0;border-radius:24px}.stage-panel{flex:1;background:#000;display:flex;align-items:center;justify-content:center}.discussion-panel{width:450px;background:#fff;display:flex;flex-direction:column}}
@media(max-width:767px){.stage-panel{flex:1;background:#000;width:100%;display:flex;align-items:center;justify-content:center}.discussion-panel{position:absolute;bottom:0;left:0;right:0;height:75vh;background:#fff;z-index:50;border-radius:20px 20px 0 0;transform:translateY(100%);transition:transform .3s}.discussion-panel.open{transform:translateY(0)}}
.discussion-header{padding:12px 16px;border-bottom:1px solid var(--outline);display:flex;align-items:center;justify-content:space-between;background:#fff}
.comment-row{display:flex;gap:16px;padding:12px 16px}.comment-avatar{width:40px;height:40px;border-radius:50%;object-fit:cover;flex-shrink:0}
.post-carousel{position:relative;width:100%;overflow:hidden;background-color:#000;aspect-ratio:4/5}
.post-carousel-inner{display:flex;transition:transform .3s ease-out;height:100%;width:100%}.post-carousel-item{min-width:100%;flex:0 0 100%;display:flex;justify-content:center;align-items:center}
.post-carousel-item img,.post-carousel-item video{width:100%;height:100%;object-fit:cover}.carousel-dot{width:6px;height:6px;border-radius:50%;background:#d1d5db;transition:background .2s}.carousel-dot.active{background:#3b82f6}
.carousel-nav-btn{position:absolute;top:50%;transform:translateY(-50%);background:rgba(0,0,0,.5);color:#fff;border-radius:50%;width:24px;height:24px;display:flex;align-items:center;justify-content:center;cursor:pointer;z-index:10;border:none}.carousel-nav-btn.prev{left:8px}.carousel-nav-btn.next{right:8px}
</style>
</head>
<body class="h-screen flex overflow-hidden p-0 md:p-3 gap-4 bg-white">
<div id="app-loader"><div class="loader-spinner"></div></div>
<div id="login-overlay" class="fixed inset-0 z-[9999] flex flex-col items-center justify-center bg-white hidden"><img src="https://i.imghippo.com/files/fRGt5603uII.png" class="w-24 h-24 mb-6"><h1 class="text-3xl font-bold mb-2">Welcome to EduLink</h1><p class="text-gray-500 mb-8">Connect, Learn, Grow.</p><button onclick="doLogin()" class="bg-[#0b57d0] text-white px-8 py-3 rounded-xl font-bold hover:bg-blue-700 transition-colors flex items-center gap-2"><i data-lucide="log-in" class="w-5 h-5"></i> Sign in with Google</button></div>
<div id="custom-alert" class="fixed inset-0 z-[80] flex items-center justify-center bg-black/40 backdrop-blur-sm hidden opacity-0 transition-opacity duration-200"><div class="bg-white rounded-2xl p-6 shadow-2xl max-w-sm w-[90%] transform scale-95 transition-transform duration-200" id="custom-alert-box"><h3 class="text-lg font-bold text-[#1f1f1f] mb-2" id="alert-title">Confirm</h3><p class="text-gray-600 mb-6 text-sm" id="alert-msg">Are you sure?</p><div class="flex justify-end gap-3"><button class="px-4 py-2 text-gray-600 font-bold text-sm hover:bg-gray-100 rounded-lg" onclick="closeAlert(false)">Cancel</button><button class="px-4 py-2 bg-[#0b57d0] text-white font-bold text-sm rounded-lg hover:bg-blue-700" id="alert-confirm-btn">Confirm</button></div></div></div>
<div id="username-modal" class="fixed inset-0 z-[90] flex items-center justify-center bg-black/60 backdrop-blur-sm hidden"><div class="bg-white w-[90%] max-w-[400px] rounded-[24px] shadow-2xl p-8 flex flex-col items-center"><h2 class="text-2xl font-bold text-[#1f1f1f] mb-2">Create Username</h2><p class="text-sm text-gray-500 mb-6">Choose a unique username.</p><div class="w-full relative mb-4"><span class="absolute left-4 top-3 text-gray-400 font-bold">@</span><input type="text" id="new-username-input" class="w-full bg-gray-100 rounded-xl py-3 pl-8 pr-4 outline-none font-medium" placeholder="username"></div><button onclick="saveUsername()" class="w-full bg-[#0b57d0] text-white py-3 rounded-xl font-bold hover:bg-blue-700">Start Exploring</button></div></div>
<div id="share-overlay" class="fixed inset-0 z-[80] flex items-end md:items-center justify-center bg-black/40 backdrop-blur-sm hidden opacity-0 transition-opacity duration-200" onclick="closeShareMenu()"><div id="share-modal" class="bg-white w-full md:w-[400px] md:rounded-[24px] rounded-t-[24px] shadow-2xl relative transform translate-y-full md:translate-y-0 md:scale-95 transition-transform duration-200 flex flex-col overflow-hidden" onclick="event.stopPropagation()"><div class="h-16 border-b border-gray-100 flex items-center justify-between px-4 shrink-0"><button onclick="closeShareMenu()" class="w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center"><i data-lucide="arrow-left" class="w-6 h-6 text-gray-700"></i></button><span class="font-bold text-gray-900 text-lg">Share</span><div class="w-10"></div></div><div class="p-6"><div id="share-post-preview" class="hidden"></div><div class="flex items-center justify-between gap-3 mb-6 p-3 bg-gray-50 rounded-xl border border-gray-200 w-full cursor-pointer hover:bg-gray-100 transition-colors" onclick="triggerShare('copy')"><div class="flex items-center gap-3 overflow-hidden"><img id="share-owner-avatar" src="" class="w-10 h-10 rounded-full border border-gray-200 object-cover shrink-0 bg-gray-200"><div class="flex flex-col min-w-0"><span class="text-xs text-gray-500 font-medium">Post Link</span><span id="share-link-text" class="font-bold text-gray-900 truncate text-sm">...</span></div></div><div class="bg-white p-2 rounded-lg border border-gray-200 shadow-sm"><i data-lucide="copy" class="w-4 h-4 text-gray-600"></i></div></div><input type="hidden" id="share-link-input"><div class="grid grid-cols-4 gap-2 mb-2"><div class="flex flex-col items-center gap-2 cursor-pointer" onclick="triggerShare('copy')"><div class="w-12 h-12 rounded-full bg-gray-100 border flex items-center justify-center"><i data-lucide="link" class="w-6 h-6"></i></div><span class="text-xs font-medium">Copy</span></div></div></div></div></div>
<div id="qr-overlay" class="fixed inset-0 z-[80] flex items-end md:items-center justify-center bg-black/40 backdrop-blur-sm hidden opacity-0 transition-opacity duration-200" onclick="closeQR()"><div id="qr-modal" class="bg-white w-full md:w-[400px] md:rounded-[24px] rounded-t-[24px] shadow-2xl p-6 relative transform translate-y-full md:translate-y-0 md:scale-95 transition-transform duration-200 flex flex-col items-center" onclick="event.stopPropagation()"><div class="w-12 h-1.5 bg-gray-300 rounded-full mx-auto mb-6 md:hidden"></div><h3 class="text-lg font-bold text-gray-900 mb-2">My QR Code</h3><div class="p-4 bg-white rounded-xl border border-gray-200 shadow-sm mb-4"><img id="qr-image" src="" class="w-48 h-48 object-contain"></div><div class="flex items-center justify-between gap-3 mb-2 p-3 bg-gray-50 rounded-xl border border-gray-200 w-full cursor-pointer" onclick="copyQRLink()"><div class="flex items-center gap-3 overflow-hidden"><img id="qr-owner-avatar" src="" class="w-10 h-10 rounded-full border border-gray-200 object-cover shrink-0"><div class="flex flex-col min-w-0"><span class="text-xs text-gray-500 font-medium">Profile Link</span><span id="qr-display-name" class="font-bold text-gray-900 truncate text-sm">@username</span></div></div><div class="bg-white p-2 rounded-lg border border-gray-200 shadow-sm"><i data-lucide="copy" class="w-4 h-4 text-gray-600"></i></div></div><div class="flex items-center justify-between gap-3 mb-4 p-3 bg-gray-50 rounded-xl border border-gray-200 w-full cursor-pointer" onclick="openScanner(); closeQR()"><div class="flex items-center gap-3"><div class="w-10 h-10 rounded-full bg-white flex items-center justify-center border border-gray-200"><i data-lucide="camera" class="w-5 h-5"></i></div><div class="flex flex-col min-w-0"><span class="text-xs text-gray-500 font-medium">Scan</span><span class="font-bold text-gray-900 truncate text-sm">Scan QR Code</span></div></div><div class="bg-white p-2 rounded-lg border border-gray-200 shadow-sm"><i data-lucide="chevron-right" class="w-4 h-4 text-gray-600"></i></div></div><input type="hidden" id="qr-hidden-url"></div></div>
<div id="scanner-overlay" class="fixed inset-0 z-[100] bg-black hidden flex-col"><div class="flex justify-between items-center p-4"><button onclick="closeScanner()" class="icon-btn bg-white/10 text-white p-2 rounded-full"><i data-lucide="x" class="w-6 h-6"></i></button><span class="text-white font-bold text-lg">Scan QR Code</span><div class="w-10"></div></div><div class="flex-1 flex flex-col items-center justify-center relative"><div id="qr-reader" class="w-full max-w-sm rounded-xl overflow-hidden shadow-2xl"></div><p class="text-gray-400 mt-6 text-sm px-4 text-center">Point your camera at an EduLink QR code.</p></div></div>
<div id="post-view-overlay" class="fixed inset-0 z-[60] hidden flex justify-center items-center"><div class="absolute inset-0 bg-black/80 backdrop-blur-md" onclick="closePostView()"></div><div class="post-modal-layout scale-in relative z-10"><div id="post-view-media-container" class="stage-panel group relative"></div><div class="discussion-panel"><div class="discussion-header"><span class="font-bold text-xl text-[#0f0f0f]">Comments</span><button onclick="closePostView()" class="icon-btn hover:bg-gray-100"><i data-lucide="x" class="w-5 h-5 text-gray-500"></i></button></div><div id="post-view-scroll" class="flex-1 overflow-y-auto bg-white"><div id="post-view-comments" class="p-0"></div></div><div class="p-3 border-t border-gray-100 bg-white"><div class="flex justify-between items-center mb-3 px-1"><div class="flex gap-4"><i id="post-view-like-btn" data-lucide="heart" class="w-6 h-6 text-gray-700 cursor-pointer hover:scale-110 transition-transform"></i><span class="font-bold text-sm text-gray-900 cursor-pointer hover:underline" id="post-view-likes-count" onclick="openLikes(window.currentViewingPostId)">0 likes</span></div></div><div class="flex items-center gap-2"><img id="comment-input-avatar" src="" class="w-8 h-8 rounded-full bg-gray-200 object-cover"><textarea id="comment-input-desktop" placeholder="Add a comment..." class="flex-1 border-b border-gray-200 outline-none text-sm p-1 max-h-20 resize-none"></textarea><button onclick="submitCommentDesktop()" class="text-white bg-[#065fd4] font-medium text-sm px-4 py-2 rounded-full hover:bg-blue-700">Send</button></div></div></div></div></div>
<div id="lightbox" class="fixed inset-0 bg-black/95 z-[9999] flex justify-center items-center hidden" onclick="closeLightbox()"><button class="absolute top-8 right-8 text-white bg-white/10 rounded-full p-3 hover:bg-white/20"><i data-lucide="x" class="w-8 h-8"></i></button><div id="lightbox-wrapper" class="w-full h-full flex justify-center items-center p-6"></div></div>
<div id="toast" class="toast"><i id="toast-icon" data-lucide="check-circle-2" class="w-5 h-5 text-[#c4eed0]"></i><span id="toast-msg">Action Completed</span></div>
<div id="create-menu-overlay" class="fixed inset-0 z-50 flex items-center justify-center bg-[#000]/40 backdrop-blur-sm hidden" onclick="closeCreateMenu()"><div id="create-menu-modal" class="bg-white w-[90%] max-w-[500px] rounded-[24px] shadow-2xl p-6 relative transform scale-95 transition-transform duration-200" onclick="event.stopPropagation()"><div class="flex justify-between items-center mb-6"><h2 class="text-xl font-bold text-[#1f1f1f] google-font">Create New</h2><button onclick="closeCreateMenu()" class="icon-btn hover:bg-[#f0f4f9] p-2 rounded-full"><i data-lucide="x" class="w-5 h-5"></i></button></div><div class="grid grid-cols-1 gap-4"><div class="create-option-card" onclick="openCompose()"><div class="create-icon-bg"><i data-lucide="pen-tool" class="w-6 h-6"></i></div><span class="font-bold text-[#1f1f1f]">Post</span></div></div></div></div>
<div id="edit-profile-overlay" class="fixed inset-0 z-50 flex items-end md:items-center justify-center bg-black/40 backdrop-blur-sm hidden" onclick="closeEditProfile()"><div id="edit-profile-modal" class="bg-white w-full h-full md:h-auto md:w-[95%] md:max-w-[500px] md:max-h-[90vh] md:rounded-[24px] rounded-none shadow-2xl relative flex flex-col overflow-hidden" onclick="event.stopPropagation()"><div class="flex justify-between items-center h-16 px-4 border-b border-gray-100 shrink-0 bg-white"><button onclick="closeEditProfile()" class="w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center"><i data-lucide="arrow-left" class="w-6 h-6 text-gray-700"></i></button><h2 class="text-lg font-bold google-font">Edit Profile</h2><div class="w-10"></div></div><div class="flex-1 overflow-y-auto p-0 pb-20 md:pb-6 relative"><div class="relative"><div id="banner-edit-area" class="h-36 w-full bg-gray-200 relative overflow-hidden cursor-grab group" onclick="document.getElementById('edit-banner-input').click()"><img id="edit-banner-preview" src="" class="w-full h-full object-cover pointer-events-none select-none"></div><div class="absolute -bottom-10 left-4"><div class="relative group cursor-pointer" onclick="document.getElementById('edit-avatar-input').click()"><img id="edit-avatar-preview" src="" class="w-24 h-24 rounded-full border-4 border-white bg-gray-100 object-cover"></div></div></div><div class="mt-12 px-6 flex flex-col gap-6"><input type="file" id="edit-avatar-input" class="hidden" accept="image/*" onchange="handleEditAvatarSelect(event)"><input type="file" id="edit-banner-input" class="hidden" accept="image/*" onchange="handleEditBannerSelect(event)"><div><label class="text-xs font-bold text-gray-500 uppercase">Display Name</label><input type="text" id="edit-name" class="w-full border-b border-gray-200 py-2 outline-none font-medium text-gray-900 text-lg"></div><div><label class="text-xs font-bold text-gray-500 uppercase">Username</label><input type="text" id="edit-username" class="w-full border-b border-gray-200 py-2 outline-none font-medium text-gray-900"></div><div><label class="text-xs font-bold text-gray-500 uppercase">Bio</label><textarea id="edit-bio" class="w-full border-b border-gray-200 py-2 outline-none text-sm text-gray-700 resize-none" rows="3"></textarea></div></div></div><div class="p-4 border-t border-gray-100 bg-white"><button id="save-profile-btn" onclick="saveProfileChanges()" class="w-full bg-gray-100 text-gray-900 py-3 rounded-xl font-bold hover:bg-gray-200">Save Changes</button></div></div></div>
<div id="compose-overlay" class="fixed inset-0 z-[55] flex items-end md:items-center justify-center bg-[#000]/40 backdrop-blur-sm hidden" onclick="attemptCloseCompose()"><div id="compose-modal" class="bg-white w-full h-full md:h-auto md:w-[95%] md:max-w-[620px] rounded-none md:rounded-[24px] shadow-2xl relative flex flex-col overflow-hidden" onclick="event.stopPropagation()"><div id="compose-progress-overlay" class="absolute inset-0 bg-white/90 backdrop-blur-sm z-[60] hidden flex-col items-center justify-center"><div class="w-64 h-2 bg-gray-200 rounded-full overflow-hidden mb-4"><div id="post-progress-bar" class="h-full bg-[#0b57d0] transition-all duration-300 w-0"></div></div><p class="font-bold text-gray-900 animate-pulse">Posting...</p></div><div class="flex items-center justify-between h-16 px-4 border-b border-gray-100"><button onclick="handleComposeBack()" class="w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center"><i data-lucide="arrow-left" class="w-6 h-6 text-gray-700"></i></button><span class="text-lg font-bold text-gray-900" id="compose-header-title">Create Post</span><div class="w-10"></div></div><div id="compose-body" class="flex-1 overflow-y-auto relative"><div id="compose-step-1" class="p-4 h-full flex flex-col"><div class="grid grid-cols-2 gap-4" id="media-grid-container"></div></div><div id="compose-step-2" class="p-4 hidden"><div class="flex gap-3 mb-4 items-center"><img id="compose-avatar" src="" class="w-10 h-10 rounded-full border border-gray-100 bg-gray-50 object-cover"><div><div id="compose-name" class="text-[15px] font-bold text-[#1f1f1f]">User</div></div></div><textarea id="compose-text" placeholder="What's on your mind?" class="w-full min-h-[150px] text-lg resize-none border-none outline-none bg-transparent placeholder-gray-400"></textarea></div></div><div class="bg-white border-t border-gray-100 z-10"><div id="compose-footer-settings" class="hidden border-b border-gray-100"><div class="flex items-center justify-between p-3"><span class="text-xs font-bold text-gray-500 uppercase">Private</span><input type="checkbox" id="post-setting-privacy" class="accent-blue-600 w-4 h-4"></div><div class="flex items-center justify-between p-3"><span class="text-xs font-bold text-gray-500 uppercase">Likes</span><input type="checkbox" id="post-setting-likes" class="accent-blue-600 w-4 h-4" checked></div><div class="flex items-center justify-between p-3"><span class="text-xs font-bold text-gray-500 uppercase">Comments</span><input type="checkbox" id="post-setting-comments" class="accent-blue-600 w-4 h-4" checked></div></div><div class="p-4"><button id="compose-action-btn" class="w-full py-3 bg-gray-100 text-gray-900 font-bold rounded-xl hover:bg-gray-200 transition-colors" onclick="handleComposeAction()">Skip</button></div></div></div></div>
<aside id="main-sidebar" class="hidden md:flex app-panel"><div class="h-12 flex items-center gap-3 mb-6 px-2 cursor-pointer" onclick="switchView('feed')"><img src="https://i.imghippo.com/files/fRGt5603uII.png" class="w-8 h-8 object-contain"><h1 class="text-[20px] font-bold text-[#1f1f1f] hidden lg:block tracking-tight">EduLink</h1></div><button onclick="openCreateMenu()" class="create-btn hidden lg:flex"><i data-lucide="plus" class="w-5 h-5"></i><span>Create</span></button><nav class="flex-1 space-y-1"><a href="#" onclick="switchView('feed');return false;" id="nav-feed" class="nav-item active"><i data-lucide="home" class="w-5 h-5"></i> <span class="hidden lg:block">Home</span></a><a href="#" onclick="switchView('explore');return false;" id="nav-explore" class="nav-item"><i data-lucide="compass" class="w-5 h-5"></i> <span class="hidden lg:block">Explore</span></a><a href="#" onclick="showProfile(null);return false;" id="nav-profile" class="nav-item"><i data-lucide="user" class="w-5 h-5"></i> <span class="hidden lg:block">Profile</span></a></nav><div class="mt-auto pt-4 border-t border-gray-100 flex flex-col gap-2"><div class="sidebar-user group" onclick="showProfile(null)"><img id="sidebar-avatar" src="" class="w-9 h-9 rounded-full bg-gray-100 border border-gray-200 shrink-0 object-cover"><div class="hidden lg:block"><div id="sidebar-name" class="text-sm font-bold text-[#1f1f1f] truncate w-[140px]">User</div></div></div></div><button onclick="doLogout()" class="mt-2 text-xs text-gray-500 hover:text-red-500 p-2 text-center w-full">Sign Out</button></aside>
<div id="workspace-layout" class="flex-1 flex min-w-0 gap-4 relative overflow-hidden transition-all duration-300"><main id="main-panel" class="flex-1 app-panel min-w-0 relative"><header id="main-header" class="h-16 md:h-20 flex items-center justify-between px-4 md:px-6 shrink-0 z-20 absolute top-0 w-full bg-white/95 md:bg-white/90 backdrop-blur-md border-b border-[#f0f0f0]"><div class="md:hidden flex items-center gap-3 cursor-pointer" onclick="switchView('feed')"><img src="https://i.imghippo.com/files/fRGt5603uII.png" class="w-8 h-8 object-contain"><h1 class="text-lg font-bold text-[#1f1f1f] tracking-tight">EduLink</h1></div><div class="flex items-center gap-3 pl-4 ml-auto"><img id="header-avatar" src="" class="w-9 h-9 rounded-full bg-gray-100 border border-gray-200 cursor-pointer hidden md:block" onclick="showProfile(null)"></div></header>
<div id="view-feed" class="flex-1 h-full overflow-y-auto no-scrollbar p-0 bg-white pt-16 md:pt-20"><div id="feed-container"></div></div>
<div id="view-profile" class="flex-1 h-full overflow-y-auto no-scrollbar hidden bg-white"></div>
<div id="view-explore" class="flex-1 h-full overflow-y-auto no-scrollbar p-0 md:pt-20 hidden bg-white"><div class="sticky top-0 bg-white z-20 border-b border-gray-100 p-4"><div class="relative bg-gray-100 rounded-xl flex items-center px-3 py-2 w-full"><i data-lucide="search" class="w-4 h-4 text-gray-400 mr-2"></i><input type="text" id="explore-search" class="bg-transparent border-none outline-none text-sm w-full" placeholder="Search..." oninput="handleSearch(this.value)"></div></div><div id="explore-results" class="p-4 space-y-4"></div></div></main></div>
<nav id="mobile-bottom-nav" class="md:hidden fixed bottom-0 left-0 w-full bg-white border-t border-[#eaecf0] h-[64px] flex items-center justify-around z-50 pb-[env(safe-area-inset-bottom)] px-2 shadow-lg"><div class="mobile-nav-item active" onclick="switchView('feed')"><i data-lucide="home"></i></div><div class="mobile-nav-item" onclick="switchView('explore')"><i data-lucide="compass"></i></div><div class="mobile-nav-item" onclick="openCreateMenu()"><i data-lucide="plus-square"></i></div><div class="mobile-nav-item" onclick="showProfile(null)"><img id="mobile-avatar" src="" class="w-6 h-6 rounded-full border border-gray-200"></div></nav>
<input type="file" id="media-input" class="hidden" accept="image/*,video/*" onchange="handleFileSelect(event)"><input type="file" id="grid-upload-input" class="hidden" accept="image/*,video/*" onchange="onGridFileSelect(event)">
<script type="module">
import {initializeApp}from"https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";import {getAuth,onAuthStateChanged,signOut,signInWithPopup,GoogleAuthProvider}from"https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";import {getFirestore,collection,doc,getDoc,setDoc,updateDoc,deleteDoc,arrayUnion,arrayRemove,addDoc,onSnapshot,query,orderBy,where,serverTimestamp,getDocs}from"https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";import {getStorage,ref,getDownloadURL,uploadBytes}from"https://www.gstatic.com/firebasejs/10.12.0/firebase-storage.js";
const firebaseConfig={apiKey:"AIzaSyAJH79UQl0rc96Qug0DKLevO4ZI_sn8Kno",authDomain:"edulinki.firebaseapp.com",projectId:"edulinki",storageBucket:"edulinki.firebasestorage.app",messagingSenderId:"248886466474",appId:"1:248886466474:web:160043201a6b28bafbbdd3",measurementId:"G-MQBH12VL7N"};const app=initializeApp(firebaseConfig),auth=getAuth(app),db=getFirestore(app),storage=getStorage(app);
const $=i=>document.getElementById(i);
let currentUser=null,users=[],posts=[],savedPosts=[],html5QrCode;
window.currentViewingPostId=null;window.composeStep=1;window.composeImages=[null,null,null,null];window.composeImageBlobs=[null,null,null,null];window.editingPostId=null;
window.uploadToImgHippo=async(blob)=>{const r=ref(storage,`uploads/${Date.now()}_${Math.random().toString(36).slice(2)}`);await uploadBytes(r,blob);return await getDownloadURL(r)};
window.doLogin=async()=>{try{await signInWithPopup(auth,new GoogleAuthProvider())}catch(e){console.error(e);alert("Login failed")}};
window.doLogout=async()=>{await signOut(auth);$('login-overlay').classList.remove('hidden')};
onAuthStateChanged(auth,async u=>{if(u){const r=doc(db,"users",u.uid),s=await getDoc(r);if(s.exists())currentUser={id:u.uid,...s.data()};else{currentUser={id:u.uid,name:u.displayName||'User',email:u.email,avatar:u.photoURL,bio:"Hi there!",following:[],followers:[],username:u.email.split('@')[0].replace(/\./g,'_')};await setDoc(r,currentUser)}savedPosts=currentUser.saved||[];$('login-overlay').classList.add('hidden');if(!currentUser.username)$('username-modal').classList.remove('hidden');updateUI();initListeners();lucide.createIcons()}else $('login-overlay').classList.remove('hidden')});
function initListeners(){onSnapshot(collection(db,"users"),s=>{users=s.docs.map(d=>({id:d.id,...d.data()}));updateUI()});onSnapshot(query(collection(db,"posts"),orderBy("timestamp","desc")),s=>{posts=s.docs.map(d=>({id:d.id,...d.data()}));if(!$('view-feed').classList.contains('hidden'))renderFeed();if(window.currentViewingPostId)openPostView(window.currentViewingPostId)})}
window.updateUI=()=>{if(!currentUser)return;['sidebar','mobile','header','compose'].forEach(x=>$(x+'-avatar').src=currentUser.avatar);$('sidebar-name').innerText=currentUser.name;$('compose-name').innerText=currentUser.name};
window.switchView=v=>{['feed','profile','explore'].forEach(n=>$(`view-${n}`).classList.add('hidden'));$(`view-${v}`).classList.remove('hidden');document.querySelectorAll('.nav-item,.mobile-nav-item').forEach(e=>e.classList.remove('active'));$(`nav-${v}`)?.classList.add('active');if(v==='feed')renderFeed();else if(v==='explore')handleSearch($('explore-search').value)};
window.renderFeed=()=>{const c=$('feed-container');c.innerHTML="";posts.forEach(p=>c.appendChild(createPostHTML(p)))};
function createPostHTML(p){const a=users.find(u=>u.id===p.authorId)||{name:'Unknown',avatar:''},d=document.createElement('div');d.className="post-card fade-in";let mh="";if(p.media){if(p.media.length===1){const s=p.media[0];mh=s.includes('video')?`<video src="${s}" controls class="w-full mt-3 rounded-xl"></video>`:`<img src="${s}" class="w-full mt-3 rounded-xl" onclick="openLightbox('${s}')">`}else{mh=`<div class="flex overflow-x-auto gap-2 mt-3">${p.media.map(s=>`<img src="${s}" class="h-60 rounded-xl">`).join('')}</div>`}}d.innerHTML=`<div class="p-4"><div class="post-header"><div class="flex gap-3"><img src="${a.avatar}" class="post-avatar"><div onclick="showProfile('${a.id}')"><span class="font-bold">${a.name}</span><div class="text-xs text-gray-500">${new Date(p.timestamp?.toDate()).toLocaleDateString()}</div></div></div>${p.authorId===currentUser.id?`<button onclick="editPost('${p.id}')"><i data-lucide="more-horizontal"></i></button>`:''}</div><div class="text-sm mb-2">${p.content}</div>${mh}<div class="flex gap-4 mt-3"><button class="action-btn ${p.likes?.includes(currentUser.id)?'text-red-500':''}" onclick="toggleLike('${p.id}')"><i data-lucide="heart" class="w-5 h-5 ${p.likes?.includes(currentUser.id)?'fill-current':''}"></i> ${p.likes?.length||0}</button><button class="action-btn" onclick="openPostView('${p.id}')"><i data-lucide="message-circle" class="w-5 h-5"></i> ${p.comments?.length||0}</button></div></div>`;return d}
window.toggleLike=async id=>{const r=doc(db,"posts",id),p=posts.find(x=>x.id===id);if(p.likes?.includes(currentUser.id))await updateDoc(r,{likes:arrayRemove(currentUser.id)});else await updateDoc(r,{likes:arrayUnion(currentUser.id)})};
window.showProfile=(uid)=>{uid=uid||currentUser.id;const u=users.find(x=>x.id===uid);if(!u)return;const c=$('view-profile');const me=uid===currentUser.id;const fol=currentUser.following?.includes(uid);c.innerHTML=`<div class="relative h-36 bg-gray-200"><img src="${u.banner||''}" class="w-full h-full object-cover"></div><div class="px-4"><div class="flex justify-between -mt-10 mb-4"><img src="${u.avatar}" class="w-24 h-24 rounded-full border-4 border-white bg-white"><div class="mt-12 flex gap-2">${me?`<button onclick="toggleModal('edit-profile',true)" class="bg-gray-100 px-4 py-2 rounded-lg font-bold">Edit</button>`:`<button onclick="toggleFollow('${uid}')" class="${fol?'bg-gray-100':'bg-blue-600 text-white'} px-4 py-2 rounded-lg font-bold">${fol?'Following':'Follow'}</button>`}<button onclick="openQR('${uid}')" class="bg-gray-100 p-2 rounded-lg"><i data-lucide="qr-code"></i></button></div></div><h1 class="text-2xl font-bold">${u.name}</h1><div class="text-gray-500">@${u.username}</div><p class="mt-2">${u.bio}</p><div class="flex gap-4 mt-3 text-sm font-bold text-gray-600"><span>${u.following?.length||0} Following</span><span>${u.followers?.length||0} Followers</span></div><div class="mt-6 grid grid-cols-3 gap-1">${posts.filter(p=>p.authorId===uid).map(p=>`<div class="aspect-square bg-gray-100 overflow-hidden cursor-pointer" onclick="openPostView('${p.id}')">${p.media?`<img src="${p.media[0]}" class="w-full h-full object-cover">`:`<div class="p-2 text-xs">${p.content}</div>`}</div>`).join('')}</div></div>`;switchView('profile');lucide.createIcons()};
window.toggleFollow=async(uid)=>{const m=doc(db,"users",currentUser.id),t=doc(db,"users",uid);if(currentUser.following.includes(uid)){await updateDoc(m,{following:arrayRemove(uid)});await updateDoc(t,{followers:arrayRemove(currentUser.id)})}else{await updateDoc(m,{following:arrayUnion(uid)});await updateDoc(t,{followers:arrayUnion(currentUser.id)})}};
window.saveProfileChanges=async()=>{const n=$('edit-name').value,b=$('edit-bio').value;let av=currentUser.avatar,bn=currentUser.banner;if(window.currentAvatarBlob)av=await window.uploadToImgHippo(window.currentAvatarBlob);if(window.currentBannerBlob)bn=await window.uploadToImgHippo(window.currentBannerBlob);await updateDoc(doc(db,"users",currentUser.id),{name:n,bio:b,avatar:av,banner:bn});toggleModal('edit-profile',false)};
window.handleEditAvatarSelect=e=>{if(e.target.files[0]){window.currentAvatarBlob=e.target.files[0];$('edit-avatar-preview').src=URL.createObjectURL(e.target.files[0])}};window.handleEditBannerSelect=e=>{if(e.target.files[0]){window.currentBannerBlob=e.target.files[0];$('edit-banner-preview').src=URL.createObjectURL(e.target.files[0])}};
window.openCompose=()=>{window.composeStep=1;window.composeImages=[null,null,null,null];window.composeImageBlobs=[null,null,null,null];$('compose-text').value="";renderMediaGrid();toggleModal('compose',true)};
window.handleComposeAction=()=>{if(window.composeStep===1){window.composeStep=2;$('compose-step-1').classList.add('hidden');$('compose-step-2').classList.remove('hidden');$('compose-footer-settings').classList.remove('hidden');$('compose-action-btn').innerText="Post";$('compose-action-btn').onclick=window.publishPost}else window.publishPost()};
window.handleComposeBack=()=>{if(window.composeStep===2){window.composeStep=1;$('compose-step-1').classList.remove('hidden');$('compose-step-2').classList.add('hidden');$('compose-footer-settings').classList.add('hidden');$('compose-action-btn').innerText="Next";$('compose-action-btn').onclick=window.handleComposeAction}else toggleModal('compose',false)};
window.renderMediaGrid=()=>{const g=$('media-grid-container');g.innerHTML='';window.composeImages.forEach((u,i)=>{const d=document.createElement('div');d.className="aspect-square rounded-xl bg-gray-100 flex items-center justify-center overflow-hidden relative border border-gray-200 cursor-pointer";if(u){d.innerHTML=`<img src="${u}" class="w-full h-full object-cover"><button onclick="removeGridImage(${i})" class="absolute top-1 right-1 bg-black/50 text-white rounded-full p-1"><i data-lucide="x" class="w-4 h-4"></i></button>`}else{d.innerHTML='<i data-lucide="plus"></i>';d.onclick=()=>{window.currentUploadIndex=i;$('grid-upload-input').click()}}g.appendChild(d)});lucide.createIcons()};
window.onGridFileSelect=e=>{const f=e.target.files[0];if(f){const r=new FileReader();r.onload=ev=>{window.composeImages[window.currentUploadIndex]=ev.target.result;window.composeImageBlobs[window.currentUploadIndex]=f;renderMediaGrid()};r.readAsDataURL(f)}};window.removeGridImage=i=>{window.composeImages[i]=null;window.composeImageBlobs[i]=null;renderMediaGrid()};
window.publishPost=async()=>{const b=$('compose-action-btn');b.innerText="Posting...";const txt=$('compose-text').value;const uploads=await Promise.all(window.composeImageBlobs.map(async b=>b?await window.uploadToImgHippo(b):null));const media=uploads.filter(x=>x);const p={authorId:currentUser.id,content:txt,media:media.length?media:null,likes:[],comments:[],timestamp:serverTimestamp()};if(window.editingPostId)await updateDoc(doc(db,"posts",window.editingPostId),p);else await addDoc(collection(db,"posts"),p);toggleModal('compose',false);window.editingPostId=null};
window.editPost=id=>{const p=posts.find(x=>x.id===id);if(p){window.editingPostId=id;$('compose-text').value=p.content;window.composeStep=1;window.composeImages=[null,null,null,null];if(p.media)p.media.forEach((u,i)=>window.composeImages[i]=u);renderMediaGrid();toggleModal('compose',true)}};
window.openPostView=id=>{window.currentViewingPostId=id;const p=posts.find(x=>x.id===id);const c=$('post-view-comments');c.innerHTML='';if(p.comments)p.comments.forEach(cm=>c.appendChild(createCommentHTML(cm)));if(p.media){const m=p.media[0];$('post-view-media-container').innerHTML=m.includes('video')?`<video src="${m}" controls class="h-full w-full object-contain"></video>`:`<img src="${m}" class="h-full w-full object-contain">`}else $('post-view-media-container').innerHTML='';$('post-view-overlay').classList.remove('hidden')};
window.closePostView=()=>{$('post-view-overlay').classList.add('hidden');window.currentViewingPostId=null};
function createCommentHTML(c){const u=users.find(x=>x.id===c.authorId);const d=document.createElement('div');d.className="flex gap-2 mb-2";d.innerHTML=`<img src="${u.avatar}" class="w-8 h-8 rounded-full"><div class="bg-gray-100 p-2 rounded-xl text-sm"><span class="font-bold">${u.name}</span> ${c.content}</div>`;return d}
window.submitCommentDesktop=async()=>{const t=$('comment-input-desktop').value;if(!t)return;await updateDoc(doc(db,"posts",window.currentViewingPostId),{comments:arrayUnion({authorId:currentUser.id,content:t,timestamp:Date.now()})});$('comment-input-desktop').value=""};
window.openQR=id=>{const u=users.find(x=>x.id===(id||currentUser.id));$('qr-image').src=`https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(window.location.href.split('?')[0]+'?pid='+u.id)}`;$('qr-owner-avatar').src=u.avatar;$('qr-display-name').innerText='@'+u.username;toggleModal('qr',true)};
window.closeQR=()=>toggleModal('qr',false);window.openScanner=()=>{const s=$('scanner-overlay');s.classList.remove('hidden');s.classList.add('flex');html5QrCode=new Html5Qrcode("qr-reader");html5QrCode.start({facingMode:"environment"},{fps:10,qrbox:250},t=>{if(t.includes('pid=')){html5QrCode.stop();closeScanner();showProfile(new URLSearchParams(t.split('?')[1]).get('pid'))}})};window.closeScanner=()=>{html5QrCode?.stop();$('scanner-overlay').classList.add('hidden')};
window.toggleModal=(n,s)=>{const m=$(`${n}-modal`),o=$(`${n}-overlay`);if(s){o.classList.remove('hidden');setTimeout(()=>m.style.transform='translate(0)',10)}else{m.style.transform='';setTimeout(()=>o.classList.add('hidden'),200)}};
window.handleSearch=q=>{const r=$('explore-results');r.innerHTML='';if(!q){renderFeed();return}posts.filter(p=>p.content.toLowerCase().includes(q.toLowerCase())).forEach(p=>r.appendChild(createPostHTML(p)))};
window.showToast=m=>{const t=$('toast');$('toast-msg').innerText=m;t.classList.add('show');setTimeout(()=>t.classList.remove('show'),2000)};
window.saveUsername=async()=>{const u=$('new-username-input').value;if(u){await updateDoc(doc(db,"users",currentUser.id),{username:u});$('username-modal').classList.add('hidden')}};
window.openLikes=()=>{};window.openLightbox=u=>{const l=$('lightbox');l.classList.remove('hidden');$('lightbox-wrapper').innerHTML=`<img src="${u}" class="max-w-full max-h-full">`};window.closeLightbox=()=>$('lightbox').classList.add('hidden');
window.closeCreateMenu=()=>toggleModal('create-menu',false);window.closeEditProfile=()=>toggleModal('edit-profile',false);window.closeShareMenu=()=>toggleModal('share',false);window.attemptCloseCompose=()=>toggleModal('compose',false);window.closeAlert=()=>$('custom-alert').classList.add('hidden');
</script></body></html>
